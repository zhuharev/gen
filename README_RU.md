# Гегератор всего

## ТУДУ

- [ ] Разделять методы на запись и на чтение
- [ ] Сделать у методов на запись обязательность idempotency key

## Какие файлы не перезаписывает генератор при повторной генерации:

- Файлы с расширением `md`, исключение - `/API.md` - документация по АПИ.
- Файлы с суфиксом `_usecase.go` - в них нужно писать бизнес-логику. При повторной генерации новые методы пудут добавлены в конец файла.
- Файл `conf/config.yml` - файл с конфигурацией.

Все остальные файлы нельзя редактировать! Они будут перезаписаны при повторной генерации.

## Валидация

### Формат

Настройки валидации поддерживают кастомные форматы.

Формат "продолжительности" в данный момент поддерживает года: `10 years` будет переведено в соответствующий период в go.

- `minAge` - вычисляет возраст от значения и проверяет что он больше `minAge`.
- `maxAge` - вычисляет возраст от значения и проверяет что он меньше `maxAge`.

## Загрузка файлов

Для загрузки файлов необходима авторизация. Чтобы загрузить файл, необходимо послать POST-запрос на `/api/v1/upload/:servername`, где `:servername` - описанный в схеме сервер загрузки файлов. Загружаются все файлы подряд без валидации. Валидация происходит на аровне модели - идёт запрос на сервер, качается файл и проверяются условия валидации. Да, это медленно, но пока не ясно сколько и каких фото будет. Возможно добавим кэш с мета-информацией о файлах по ссылкам.

## Драйверы баз данных

### Storm (bolt)

Embeded-база данных. Можно использовать для разработки или для проектов, не требующих нескольких сервисов (когда все обзение с базой данных происходит через одно приложение). Удобна отсутсвием миграций и можно просто добавлять/удалять поля (при изменении типа могут быть проблемы чтения существующих данных).

### Postgresql

Так как эта база требует названия таблиц, их нужно указывать в схеме в поле `extensions.postgresTableName`
